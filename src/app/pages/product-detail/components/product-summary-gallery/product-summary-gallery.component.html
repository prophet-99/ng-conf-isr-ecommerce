@let product = productDetail();

<div class="product-gallery" tabindex="0" aria-label="Galería de imágenes">
  <!-- MAIN IMAGE -->
  <div class="gallery-main">
    <button
      class="gallery-nav gallery-nav--prev"
      type="button"
      aria-label="Imagen anterior"
      (click)="prev()"
      [disabled]="currentIndex() === 0 || images().length === 0"
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path
          d="M15 18l-6-6 6-6"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>

    @if(images().length === 0) {
    <div class="gallery-main__placeholder">
      <img
        src="https://images.unsplash.com/photo-1519681393784-d120267933ba?auto=format&fit=crop&w=500&q=60"
        alt="Sin imagen disponible"
        width="500"
        height="500"
        loading="lazy"
      />
    </div>
    } @else {
    <img
      class="gallery-main__image"
      [src]="mainImage() | getResource"
      [alt]="product.name + ' - imagen ' + (currentIndex() + 1)"
    />
    }

    <button
      class="gallery-nav gallery-nav--next"
      type="button"
      aria-label="Imagen siguiente"
      (click)="next()"
      [disabled]="
        currentIndex() === images().length - 1 || images().length === 0
      "
    >
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
        <path
          d="M9 18l6-6-6-6"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </button>
  </div>

  <!-- THUMBNAILS -->
  <div class="gallery-thumbnails" role="list">
    @for(img of images(); track img; let i = $index) {
    <button
      type="button"
      class="thumbnail"
      [class.thumbnail--active]="i === currentIndex()"
      (click)="setIndex(i)"
      [attr.aria-label]="'Ver imagen ' + (i + 1)"
      role="listitem"
    >
      <img
        [src]="img | getResource"
        [alt]="product.name + ' miniatura ' + (i + 1)"
        width="80"
        height="80"
        loading="lazy"
      />
    </button>
    }
  </div>

  <!-- INDICATOR -->
  <div class="gallery-indicator" aria-live="polite">
    @if(images().length > 0){
    {{ currentIndex() + 1 }} / {{ images().length }}
    }
  </div>
</div>
